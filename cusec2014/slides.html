<!doctype html>
<html lang="en">    
<head>
    <meta charset="utf-8">
    <title>You Can Be a Kernel Hacker</title>
    <link rel="stylesheet" href="reveal_js/css/reveal.min.css">
    <link rel="stylesheet" href="reveal_js/css/theme/solarized.css" id="theme">
    <style>
        #hackerschool {
            border: none;
        }
    </style>
</head>
 
<body>
    <div class="reveal">
        <div class="slides">
<section class="level1" id="you-can-be-a-kernel-hacker">
<h1>You can be a <br>kernel hacker</h1>
<p>by Julia Evans <br> <a href="https://github.com/jvns">twitter.com/b0rk</a> <br> <a href="https://twitter.com/b0rk">github.com/jvns</a> <br> <a href="http://jvns.ca">jvns.ca</a> <br></p>
</section>
<section class="level1" id="section">
<h1></h1>
<img src="hackerschool_logo.png" id="hackerschool">
</section>
<section class="level1" id="where-were-going">
<h1>Where we're going</h1>
<ol type="1">
<li>WTF is a kernel?</li>
<li>Why should you care?</li>
<li>Strategies for getting started with kernel programming
<ol type="a">
<li>Read some kernel code!</li>
<li>Write a kernel module!</li>
<li>Write your own operating system</li>
<li>Do an internship</li>
</ol></li>
</ol>
</section>
<section class="level1" id="wtf-is-a-kernel">
<h1>1. WTF is a kernel?</h1>
</section>
<section class="level1" id="kernels-are-just-code">
<h1>Kernels are <br> just code!</h1>
</section>
<section class="level1" id="section-1">
<h1></h1>
<p>When I go to http://google.com, kernel code runs for:</p>
<ul>
<li>Typing in the address</li>
<li>Handling every network packet</li>
<li>Writing history files to disk</li>
<li>Allocating memory</li>
<li>Communicating with the graphics card</li>
</ul>
</section>
<section class="level1" id="how-to-call-kernel-code">
<h1>How to call <br> kernel code</h1>
<p>System calls!!!</p>
</section>
<section class="level1" id="system-calls-a-kernels-api">
<h1>System calls: <br> a kernel's API</h1>
<ul>
<li>open a file! (<code>open</code>)</li>
<li>start a program! (<code>execve</code>)</li>
<li>change a file's permissions! (<code>chmod</code>)</li>
</ul>
</section>
<section class="level1" id="what-weve-learned">
<h1>What we've learned</h1>
<ul>
<li>Your kernel does tons of stuff</li>
<li>Programs tell it what to do using system calls</li>
</ul>
</section>
<section class="level1" id="why-should-you-care">
<h1>2. Why should you care?</h1>
<ul>
<li>People will think you're a badass</li>
<li>You'll become a better programmer</li>
</ul>
</section>
<section class="level1" id="strategies-for-getting-started">
<h1>3. Strategies for getting started</h1>
</section>
<section class="level1" id="strategy-1-read-some-kernel-code">
<h1>Strategy 1: <br> Read some <br> kernel code</h1>
</section>
<section class="level1" id="but-thats-terrifying">
<h1>BUT THAT'S TERRIFYING!!!!!</h1>
<p>Pick one system call and try to understand one thing about it</p>
</section>
<section class="level1" id="section-2">
<h1></h1>
<p>Linux kernel: LXR, <a href="http://livegrep.com">http://livegrep.com</a></p>
<p>OS X kernel: TODO FIND THIS IT IS IMPORTANT</p>
</section>
<section class="level1" id="section-3">
<h1></h1>
<p>TODO FIX THIS AND MAKE IT PRETTY</p>
<pre class="sourceCode c"><code class="sourceCode c"><span class="dt">static</span> <span class="dt">int</span> chmod_common(<span class="kw">struct</span> path *path, umode_t mode)
{
    <span class="kw">struct</span> inode *inode = path-&gt;dentry-&gt;d_inode;
    <span class="kw">struct</span> iattr newattrs;
    <span class="dt">int</span> error;

    error = mnt_want_write(path-&gt;mnt);
    <span class="kw">if</span> (error)
        <span class="kw">return</span> error;

    mutex_lock(&amp;inode-&gt;i_mutex); <span class="co">// Lock to prevent a race condition!</span>

    error = security_path_chmod(path, mode); <span class="co">// Make sure we&#39;re allowed to do this</span>
    <span class="kw">if</span> (error)
        <span class="kw">goto</span> out_unlock;
    newattrs.ia_mode = (mode &amp; S_IALLUGO) | (inode-&gt;i_mode &amp; ~S_IALLUGO);
    newattrs.ia_valid = ATTR_MODE | ATTR_CTIME;
    error = notify_change(path-&gt;dentry, &amp;newattrs);
out_unlock:
    mutex_unlock(&amp;inode-&gt;i_mutex); <span class="co">// We&#39;re done, so the mutex is over!</span>
    mnt_drop_write(path-&gt;mnt); <span class="co">// ???</span>
    <span class="kw">return</span> error;
}</code></pre>
</section>
<section class="level1" id="strategy-2-write-a-kernel-module">
<h1>Strategy 2: <br> Write a <br> kernel module</h1>
<p>DEMO DEMO DEMO</p>
</section>
<section class="level1" id="section-4">
<h1></h1>
<pre><code>static int __init rickroll_init(void) {
    sys_call_table = find_sys_call_table();
    DISABLE_WRITE_PROTECTION;
    original_sys_open = (void *) sys_call_table[__NR_open];
    sys_call_table[__NR_open] = (unsigned long *) rickroll_open;
    ENABLE_WRITE_PROTECTION;
    return 0;  /* zero indicates success */
}

static void __exit rickroll_cleanup(void)
{
    printk(KERN_INFO &quot;Ok, now we&#39;re gonna give you up. Sorry.\n&quot;);

    /* Restore the original sys_open in the table */
    DISABLE_WRITE_PROTECTION;
    sys_call_table[__NR_open] = (unsigned long *) original_sys_open;
    ENABLE_WRITE_PROTECTION;
}</code></pre>
</section>
<section class="level1" id="section-5">
<h1></h1>
<pre><code>static char *rickroll_filename = &quot;/home/bork/media/music/Rick Astley - Never Gonna Give You Up.mp3&quot;;

asmlinkage long rickroll_open(const char __user *filename, int flags, umode_t mode)
{
    int len = strlen(filename);

    if(strcmp(filename + len - 4, &quot;.mp3&quot;)) { // Leave it alone
        return (*original_sys_open)(filename, flags, mode);
    } else {
        mm_segment_t old_fs;
        long fd;
        old_fs = get_fs();
        set_fs(KERNEL_DS);
        /* Open the rickroll file instead */
        fd = (*original_sys_open)(rickroll_filename, flags, mode);
        set_fs(old_fs);
        return fd;
    }
}</code></pre>
</section>
<section class="level1" id="okay-no-more-code-i-promise">
<h1>Okay no more <br> code I promise</h1>
</section>
<section class="level1" id="strategy-3-write-your-own-os">
<h1>Strategy 3: <br> Write your own OS</h1>
</section>
<section class="level1" id="strategy-4-do-a-kernel-internship">
<h1>Strategy 4: <br> Do a kernel internship</h1>
</section>
<section class="level1" id="internships">
<h1>Internships</h1>
<ul>
<li>Google Summer of Code</li>
<li>GNOME Outreach Program for Women</li>
</ul>
</section>
<section class="level1" id="blogging-awesome">
<h1>Blogging = awesome</h1>
<p>While at Hacker School:</p>
<ul>
<li>I wrote 50 blog posts</li>
<li>7 of them were on Hacker News</li>
<li>1200 people followed me on Twitter</li>
<li>100,000 people visited my blog</li>
<li>Lots of those blog posts are bad. Nobody cares about the bad posts.</li>
</ul>
</section>
<section class="level1" id="section-6">
<h1></h1>
<img src="apple-email.png" id="apple">
</section>
<section class="level1" id="talk-to-me">
<h1>Talk to me!</h1>
<ul>
<li>Hacker School</li>
<li>All-Girl Hack Night / PyLadies</li>
<li>Data science</li>
<li>Interviewing</li>
<li>Promoting yourself</li>
</ul>
</section>
<section class="level1" id="questions">
<h1>Questions?</h1>
<p><code>http://github.com/jvns</code> <br> <code>http://twitter.com/b0rk</code> <br> <code>julia@jvns.ca</code></p>
<p>Resources:</p>
<p><code>http://bit.ly/kernelfun</code></p>
</section>
        </div>
    </div>
    <script src="reveal_js/lib/js/head.min.js"></script>
    <script src="reveal_js/js/reveal.min.js"></script>
    <script>
        // Required, even if empty.
        Reveal.initialize({
            controls: false,
            progress: true,
            rollingLinks: false,
            transition: "none",
            maxScale: 10.0,
        });
    </script>
</body>
</html>
